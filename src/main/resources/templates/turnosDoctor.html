<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Mostrar Disponibilidades</title>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
        <link href="/css/turnero.css" rel="stylesheet">
        
    </head>


    <body>

        <div class="container-fluid mt-2">

            <div class="row align-items-center">

                <div class="col-2 text-right">
                    <a href="#" class="d-flex flex-column align-items-center">
                        <i class="fas fa-chevron-left fa-4x"></i> Semana Anterior
                    </a>
                </div>


                <div class="col"> <!-- Centrar el contenido -->


                    <form th:action="@{/turnero/reserva}" method="post">
                        <h1 class="text-center mb-4">
                            Calendario de Disponibilidades - Dr. <span th:text="${doctor.nombre}"></span>
                        </h1>

                        <table class="table text-center">

                            <thead class="thead-dark">
                                <tr>
                                    <th th:text="'Domingo ' + ${#dates.format(turnero[0][0].fechaInicio, 'dd/MM')}"></th>
                                    <th th:text="'Lunes ' + ${#dates.format(turnero[0][1].fechaInicio, 'dd/MM')}"></th>
                                    <th th:text="'Martes  ' + ${#dates.format(turnero[0][2].fechaInicio, 'dd/MM')}"></th>
                                    <th th:text="'MiÃ©rcoles ' + ${#dates.format(turnero[0][3].fechaInicio, 'dd/MM')}"></th>
                                    <th th:text="'Jueves ' + ${#dates.format(turnero[0][4].fechaInicio, 'dd/MM')}"></th>
                                    <th th:text="'Viernes ' + ${#dates.format(turnero[0][5].fechaInicio, 'dd/MM')}"></th>
                                    <th th:text="'Sabado ' + ${#dates.format(turnero[0][6].fechaInicio, 'dd/MM')}"></th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr th:each="row : ${turnero}"> <!-- Iterar sobre las filas -->
                                    <td th:each="turno : ${row}"> <!-- Iterar sobre los turnos de cada fila -->
                                        <div th:class="contenedorBurbuja">
                                            <div th:class="${turno != null and turno.disponible == true and turno.reservado != true ? 'burbuja burbujaDisponible' 
                                                 : (turno != null and turno.reservado != null and turno.reservado == true ? 'burbuja burbujaReservada' : 'burbuja')}">
                                                <span th:if="${turno !=null}" th:text="${#dates.format(turno.fechaInicio, 'H:mm') + 'h'}"></span>
                                            </div>
                                            <input type="radio" th:if="${turno != null and turno.disponible == true and turno.reservado != true and #authorization.expression('hasRole(''ROLE_PACIENTE'')')}" th:name="'turnoId'" th:value="${turno.id}" />
                                            <a th:if="${turno != null and turno.reservado == true}" th:href="@{'/turnero/ver-turno/' + ${turno.id}}">Ver turno</a>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>

                        </table>
                        <button type="submit" th:if="${#authorization.expression('hasRole(''ROLE_PACIENTE'')')}">Reservar turno</button>
                    </form>                    
                </div>


                <div class="col-2">
                    <a href="#" class="d-flex flex-column align-items-center">
                        Semana Siguiente <i class="fas fa-chevron-right fa-4x"></i>
                    </a>
                </div>

            </div>
        </div>

    </body>

</html>